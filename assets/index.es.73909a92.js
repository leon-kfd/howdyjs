class O{constructor({el:t,options:e}){t instanceof HTMLElement?this.el=t:this.el=document.querySelector(t),this.options=Object.assign({immediate:!1,direction:["right"],scrollElSelector:null,lineColor:"#aab",lineWidth:2,lineHoverColor:"#88f",lineHoverWidth:4,tipLineColor:"#262626",tipLineWidth:1,tipLineStyle:"dashed",zIndex:999,needParentNodeOffset:!0},e),this.directionArr=this.options.direction||["right"],this.el.$resize=this}init(){const{position:t}=getComputedStyle(this.el),{position:e}=getComputedStyle(this.el.parentNode);t==="static"&&(this.el.style.position="relative"),e==="static"&&console.warn("[@howdyjs/resize] Element parentNode position can not be static!"),this.directionArr.map(o=>{if(this.options.immediate){const i=this.createLineEl(o);this.el.appendChild(i)}else{const i=this.createDashedLineEl(o),n=this.createLineEl(o,i);this.el.appendChild(i),this.el.appendChild(n)}})}createDashedLineEl(t){const{tipLineColor:e,tipLineWidth:o,tipLineStyle:i,zIndex:n}=this.options,u=document.createElement("div"),f=`position:absolute;z-index: ${n};visibility: hidden;`,z=t==="left"||t==="right";return u.style.cssText=z?`${f};top:0;bottom: 0;${t}:0;border-${t}:${o}px ${i} ${e}`:`${f};left:0;right: 0;${t}:0;border-${t}:${o}px ${i} ${e}`,u.setAttribute("class","resize__dashed-line"),u}createLineEl(t,e){const{immediate:o,lineColor:i,lineWidth:n,lineHoverColor:u,lineHoverWidth:f,zIndex:z}=this.options,s=document.createElement("div"),x=`position: absolute;background: ${i};z-index: ${z}`,r=t==="left"||t==="right",p=t==="right"||t==="bottom";s.style.cssText=r?`${x};width: ${n}px;top:0;bottom: 0;${t}: -${n/2}px;cursor: col-resize;`:`${x};height: ${n}px;left:0;right: 0;${t}: -${n/2}px;cursor: row-resize;`,s.mouseoverEvent=function(){s.style.background=u,s.style[r?"width":"height"]=`${f}px`,s.style[t]=`-${f/2}px`},s.mouseoutEvent=function(){s.style.background=i,s.style[r?"width":"height"]=`${n}px`,s.style[t]=`-${n/2}px`};const c=this.el;return s.mousedownEvent=function(w){const L=(c||w.target.parentNode).parentNode;let d;const b=r?L.offsetWidth:L.offsetHeight;document.body.style.userSelect="none";let E=!0;const C=()=>{const m=r?c.offsetWidth:c.offsetHeight,v=r?c.offsetLeft:c.offsetTop,y=p?v+m+d:v+d,h=p?m+d:m-d,a=document.createEvent("HTMLEvents");a.initEvent("resize",!1,!1),a.direction=t,a.moveOffset=y,a.moveOffsetPercent=y/b*100,a[r?"resizeWidth":"resizeHeight"]=h,a[r?"resizeWidthPercent":"resizeHeightPercent"]=h/b*100,c.dispatchEvent(a)};document.onmousemove=function(m){m.preventDefault();const{x:v,y}=c.getBoundingClientRect(),h=r?c.offsetWidth:c.offsetHeight,a=r?c.offsetLeft:c.offsetTop;d=p?r?m.clientX-v-h:m.clientY-y-h:r?m.clientX-v:m.clientY-y,E=p?-d<=h&&a+h+d<=b:d<=h&&a+d>=0,E&&(o?C():e&&(e.style.visibility="visible",e.style[t]=`${p?-d:d}px`))},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,document.body.style.userSelect="auto",o||(e&&(e.style.visibility="hidden"),E&&(C(),e&&(e.style[t]="0px")))}},s.setAttribute("class","resize__line"),s.addEventListener("mousemove",s.mouseoverEvent),s.addEventListener("mouseout",s.mouseoutEvent),s.addEventListener("mousedown",s.mousedownEvent),s}destroy(){Array.prototype.slice.call(this.el.querySelectorAll(".resize__line")).forEach(e=>{e.mouseoverEvent&&e.removeEventListener("mousemove",e.mouseoverEvent),e.mouseoutEvent&&e.removeEventListener("mouseout",e.mouseoutEvent),e.mousedownEvent&&e.removeEventListener("mousedown",e.mousedownEvent),e.parentNode&&e.parentNode.removeChild(e)}),this.el.querySelectorAll(".resize__dashed-line").forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)})}}const g=(l,t,e)=>{const{arg:o,value:i}=t,n=e||{};let u,f;o&&(o==="all"?u=["top","left","bottom","right"]:u=[o]),u?f=Object.assign(Object.assign(Object.assign({},n),i),{direction:u}):f=Object.assign(Object.assign({},n),i),new O({el:l,options:f}).init()},$=l=>{l.$resize&&l.$resize.destroy()},H={mounted:(l,t)=>g(l,t),unmounted:$,inserted:(l,t)=>g(l,t),unbind:$,install:(l,t)=>{l.directive("resize",{mounted:(e,o)=>g(e,o,t),unmounted:$,inserted:(e,o)=>g(e,o,t),unbind:$})}};export{H as R};
