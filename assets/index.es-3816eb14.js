var K=Object.defineProperty,Q=(i,t,e)=>t in i?K(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,k=(i,t,e)=>(Q(i,typeof t!="symbol"?t+"":t,e),e);class U{constructor({el:t,options:e}){k(this,"el"),k(this,"options"),k(this,"directionArr"),k(this,"timer"),k(this,"scrollWrapper"),t instanceof HTMLElement?this.el=t:this.el=document.querySelector(t),this.options={direction:"y",scrollBarWidth:6,scrollBarOffsetX:0,scrollBarOffsetY:0,scrollBarThumbColor:"#aab",scrollBarThumbBorderRadius:!0,scrollBarTrackColor:"transparent",enableTrackClickScroll:!0,scrollSpeed:20,dragScroll:!1,thumbShow:"always",...e},this.directionArr=this.options.direction==="all"?["x","y"]:["x","y"].includes(this.options.direction)?[this.options.direction]:["y"],this.timer=null,this.el.$scroll=this}init(t=0,e=0){this.scrollWrapper=document.createElement("div"),this.scrollWrapper.style.cssText=`position: absolute;top:0;left:0;bottom:0;right:0;transform:translate(${t}px,${e}px)`,this.scrollWrapper.setAttribute("class","scroll__wrapper"),this.el.appendChild(this.scrollWrapper),this.el.style.position="relative",this.el.style.overflow="hidden",this.directionArr.map(o=>{this.createScrollBarTrack(o)}),this.options.dragScroll&&this.setDragScroll(this.el,this.directionArr),this.options.thumbShow==="hover"&&this.setDisplayForHover(this.el)}createScrollBarTrack(t){const e=t==="y";let{scrollBarWidth:o,scrollBarOffsetX:s,scrollBarOffsetY:p,scrollBarThumbColor:c,scrollBarThumbHoverColor:a,scrollBarThumbBorderRadius:b,scrollBarTrackColor:y,enableTrackClickScroll:H,scrollSpeed:A}=this.options;const E=c.includes("gradient");b=b?o/2:0;const h=document.createElement("div");h.setAttribute("direction",t);const M=e?`position: absolute;right: 0;top: 0;height: 100%; width: ${o+s*2}px;background: ${y};`:`position: absolute;left: 0;bottom: 0;width: 100%; height: ${o+s*2}px;background: ${y};`;h.style.cssText=M,h.setAttribute("class",`scroll__track_${t}`),this.scrollWrapper&&this.scrollWrapper.appendChild(h);const f=document.createElement("div");let Y=e?`position: relative;top: 0;right: 0;width: ${o+s*2}px;padding: ${p}px ${s}px;box-sizing:border-box;cursor: pointer;`:`position: relative;bottom: 0;left: 0;height: ${o+s*2}px;padding: ${s}px ${p}px;box-sizing:border-box;cursor: pointer;`;const T=document.createElement("div");let v=`width: 100%;height:100%;border-radius: ${b}px;`;E?v+=`background-image: ${c};`:v+=`background: ${c};`;const{offsetHeight:g,scrollHeight:S,offsetWidth:w,scrollWidth:C,scrollTop:I,scrollLeft:N}=this.el,m=e?g:w,x=e?S:C;if(x<=m)return;const L=m/x*m;Y+=e?`height: ${L}px;`:`width: ${L}px`,f.style.cssText=Y,f.setAttribute("class","scroll__thumb"),T.style.cssText=v,T.setAttribute("class","scroll__thumb_inner"),f.appendChild(T),h.appendChild(f);let r=e?I:N;const z=r/x*m;f.style.transform=e?`translateY(${z}px)`:`translateX(${z}px)`;let q=!1;const B=x-m,_=m-L;e&&(this.el.onmousewheel=function(u){const l=-u.wheelDelta||u.deltaY;return q||(r=l<0?r<-l?0:r+l:r>=B-l?B:r+l,D(h,r/x*m)),!1}),a&&(f.onmouseenter=function(){a&&(T.style.background=a)},f.onmouseleave=function(){T.style.background=c}),f.onmousedown=function(u){u.stopPropagation();const l=u.target.parentNode,$=e?u.clientY:u.clientX,[d]=l.style.transform.match(/\d+(\.\d+)?/)||[0],n=~~d;q=!0,document.onmousemove=function(R){document.body.style.userSelect="none";const{clientY:G,clientX:J}=R;let X=(e?G:J)-$+n;r=X/m*x,r<0?(X=0,r=0):r>B&&(X=_,r=B),D(h,X)},document.onmouseup=function(){q=!1,document.body.style.userSelect="auto",document.onmousemove=null,document.onmouseup=null}},H&&(h.onmousedown=function(u){const l=u.target;if(l){let d=(e?u.clientY-l.getBoundingClientRect().top:u.clientX-l.getBoundingClientRect().left)-L/2;d<0?d=0:d>_&&(d=_),D(l,d)}});let O,W;const D=(u,l)=>{W&&window.cancelAnimationFrame(W),O=()=>{let $,d,[n]=u.childNodes[0].style.transform.match(/\d+(\.\d+)?/)||[0];n=~~n,l>n?(n+=A,n<l?(r=n/m*x,$=n,d=!1):(r=n>_?B:l/m*x,$=n>_?_:l,d=!0)):(n-=A,n>l?(r=n/m*x,$=n,d=!1):(r=n<0?0:l/m*x,$=n<0?0:l,d=!0)),this.setTranslate(t,r),f.style.transform=e?`translateY(${$}px)`:`translateX(${$}px)`,e?this.el.scrollTop=r:this.el.scrollLeft=r,d?window.cancelAnimationFrame(W):W=window.requestAnimationFrame(O)},W=window.requestAnimationFrame(O)}}update(t=200){this.timer!==null&&clearTimeout(this.timer),this.timer=setTimeout(()=>{if(this.scrollWrapper){const{transform:e}=window.getComputedStyle(this.scrollWrapper),[,,,,o,s]=e.match(/-?\d+\.?\d{0,}/g),p=~~o,c=~~s;this.destroy(),this.init(p,c)}},t)}destroy(){var t;this.scrollWrapper&&((t=this.scrollWrapper.parentNode)==null||t.removeChild(this.scrollWrapper),this.scrollWrapper=null),this.el.mouseenterEvent&&this.el.addEventListener("mouseenter",this.el.mouseenterEvent),this.el.mouseleaveEvent&&this.el.addEventListener("mouseleave",this.el.mouseleaveEvent)}setTranslate(t,e){if(this.scrollWrapper){const{transform:o}=window.getComputedStyle(this.scrollWrapper),[s,p,c,a,b,y]=o.match(/-?\d+\.?\d{0,}/g);t==="x"?this.scrollWrapper.style.transform=`matrix(${s},${p},${c},${a},${e},${y})`:t==="y"&&(this.scrollWrapper.style.transform=`matrix(${s},${p},${c},${a},${b},${e})`)}}setDisplayForHover(t){const e="opacity: 0;transition: opacity .4s ease-in-out",o=Array.from(t.querySelectorAll(".scroll__thumb"));o.map(s=>{s.style.cssText=s.style.cssText+e}),t.mouseenterEvent=function(){o.map(s=>{s.style.opacity="1"})},t.mouseleaveEvent=function(){o.map(s=>{s.style.opacity="0"})},t.addEventListener("mouseenter",t.mouseenterEvent),t.addEventListener("mouseleave",t.mouseleaveEvent)}setDragScroll(t,e){t.onmousedown=function(o){const{scrollTop:s,scrollLeft:p,scrollHeight:c,offsetHeight:a,scrollWidth:b,offsetWidth:y}=t,{clientX:H,clientY:A}=o,[E,h]=[b-y,c-a],[M,f]=[y-y/b*y,a-a/c*a];document.body.style.userSelect="none",document.body.style.cursor="pointer",document.onmousemove=function(Y){const{clientX:T,clientY:v}=Y;let[g,S]=[H-T+p,A-v+s],[w,C]=[g/b*y,S/c*a];g<0?(w=0,g=0):g>E&&(w=M,g=E),S<0?(C=0,S=0):S>h&&(C=f,S=h),t.querySelector(".scroll__wrapper").style.transform=`translate(${g}px, ${S}px)`,e.includes("x")&&(t.querySelector(".scroll__track_x .scroll__thumb").style.transform=`translateX(${w}px)`),e.includes("y")&&(t.querySelector(".scroll__track_y .scroll__thumb").style.transform=`translateY(${C}px)`),t.scrollTop=S,t.scrollLeft=g},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,document.body.style.userSelect="default",document.body.style.cursor="default"}}}}const P=(i,t,e)=>{const{arg:o,value:s}=t,p=/(Android|iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent),c=e||{};if(!p){const a={...c,...s,direction:o};new U({el:i,options:a}).init()}},F=i=>{i.$scroll&&i.$scroll.destroy()},V={mounted:(i,t)=>P(i,t),unmounted:F,inserted:(i,t)=>P(i,t),unbind:F,install:(i,t)=>{i.directive("scroll",{mounted:(e,o)=>P(e,o,t),unmounted:F,inserted:(e,o)=>P(e,o,t),unbind:F})}};export{V as S};
