import{T as t}from"./index.es.5eac8f7c.js";class o extends t{constructor({el:t,options:o}){super({el:t,options:Object.assign({adsorb:0,adsorbOffset:0,isAbsolute:!1,positionMode:1},o)}),this.arrowCtx=null,this.arrowStartX=0,this.arrowStartY=0,this.elWidth=0,this.elHeight=0,this.resizeFlag=!1,this.arrowMouseDownEvent=t=>{const o=this.isTouch?t.changedTouches[0].clientX:t.x,e=this.isTouch?t.changedTouches[0].clientY:t.y,{width:i,height:s,left:n,top:r}=this.el.getBoundingClientRect(),{width:h,height:l}=this.parent.getBoundingClientRect();let a,d;this.arrowStartX=o,this.arrowStartY=e,this.elWidth=i,this.elHeight=s,this.resizeFlag=!0,this.controlOptions.isAbsolute?(a=h-this.el.offsetLeft-this.borderInfo[1]-this.borderInfo[3],d=l-this.el.offsetTop-this.borderInfo[0]-this.borderInfo[2]):(a=window.innerWidth-n,d=window.innerHeight-r),setTimeout((()=>{this.isDrag=!1})),this.el.style.left=`${this.controlOptions.isAbsolute?this.el.offsetLeft:n}px`,this.el.style.top=`${this.controlOptions.isAbsolute?this.el.offsetTop:r}px`,this.el.style.right="auto",this.el.style.bottom="auto",this.emitControlEvent("tocontrolstart"),this.isTouch?(document.ontouchmove=t=>{if(!this.resizeFlag||!t.changedTouches)return;const{clientX:o,clientY:e}=t.changedTouches[0];this.el.style.width=`${Math.min(this.elWidth+o-this.arrowStartX,a)}px`,this.el.style.height=`${Math.min(this.elHeight+e-this.arrowStartY,d)}px`,this.emitControlEvent("tocontrolmove")},document.ontouchend=()=>{this.setPosition(),this.resizeFlag=!1,document.ontouchmove=null,document.ontouchend=null,this.emitControlEvent("tocontrolend")}):(document.onmousemove=t=>{if(!this.resizeFlag)return;const{x:o,y:e}=t;this.el.style.width=`${Math.min(this.elWidth+o-this.arrowStartX,a)}px`,this.el.style.height=`${Math.min(this.elHeight+e-this.arrowStartY,d)}px`,this.emitControlEvent("tocontrolmove")},document.onmouseup=()=>{this.setPosition(),this.resizeFlag=!1,document.onmousemove=null,document.onmouseup=null,this.emitControlEvent("tocontrolend")})},this.controlOptions=o||{},this.initControl()}initControl(){var t;const{position:o}=getComputedStyle(this.el);if(!["fixed","absolute"].includes(o))throw new Error("Control just work in the element which position is fixed or absolute.");this.arrowCtx=this.createResizeArrow(null===(t=this.controlOptions)||void 0===t?void 0:t.arrowOptions),this.el.appendChild(this.arrowCtx)}createResizeArrow(t){const o=Object.assign({size:8,lineWidth:2,lineColor:"#9a9a9a",padding:2},t),e=document.createElement("div"),i=`\n      position: absolute;\n      right: ${o.padding}px; \n      bottom: ${o.padding}px;\n      width: ${o.size}px;\n      height: ${o.size}px;\n      border-bottom: ${o.lineWidth}px solid ${o.lineColor};\n      border-right: ${o.lineWidth}px solid ${o.lineColor};\n      cursor: se-resize;\n      background: ${o.background||"none"}\n    `;return e.className="to-control-arrow",e.style.cssText=i,this.isTouch?e.addEventListener("touchstart",this.arrowMouseDownEvent):e.addEventListener("mousedown",this.arrowMouseDownEvent),e}destroyControl(){var t,o;this.destroy(),this.isTouch?null===(t=this.arrowCtx)||void 0===t||t.removeEventListener("touchstart",this.arrowMouseDownEvent):null===(o=this.arrowCtx)||void 0===o||o.removeEventListener("mousedown",this.arrowMouseDownEvent)}emitControlEvent(t){const o=document.createEvent("HTMLEvents");o.initEvent(t,!1,!1);const{left:e,top:i,right:s,bottom:n,width:r,height:h,maxX:l,maxY:a}=this;o.left=e,o.top=i,o.width=r,o.height=h,o.maxX=l,o.maxY=a,o.right=s,o.bottom=n,this.el.dispatchEvent(o)}}const e=(t,e,i)=>{const{value:s}=e,n=i||{},r=Object.assign(Object.assign({},n),s);t.$toControl=new o({el:t,options:r})},i=t=>{t.$toControl&&t.$toControl.destroy()},s={mounted:(t,o)=>e(t,o),unmounted:i,inserted:(t,o)=>e(t,o),unbind:i,install:(t,o)=>{t.directive("to-control",{mounted:(t,i)=>e(t,i,o),unmounted:i,inserted:(t,i)=>e(t,i,o),unbind:i})}};export{o as T,s as a};
