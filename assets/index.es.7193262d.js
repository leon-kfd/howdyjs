import{a as e,b as n,_ as t}from"./tslib.es6.d5acbd82.js";import{d as a,f as i,e as _,h as u,c as o,F as m,m as r,n as d,T as s,w as l,p as c,b,o as v,l as p,k as h,y as f,a as w,t as y,A as g,B as x,C}from"./index.90e6cb6f.js";var S=function(e){var n=Array.isArray(e)?[]:{};if(e&&"object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&(e[t]&&"object"==typeof e[t]?n[t]=S(e[t]):n[t]=e[t]);return n},k=a({name:"MouseMenu",props:{appendToBody:{type:Boolean,default:!0},menuWidth:Number,menuList:{type:Array,required:!0},menuHiddenFn:{type:Function},hasIcon:Boolean,iconType:String,menuWrapperCss:Object,menuItemCss:Object,el:{type:Object,required:!0},params:{type:[String,Number,Array,Object]}},setup:function(t){var a=this,o=i(0),m=i(0),r=i(!1),d=i(0),s=i(0),l=i(!1),c=i(null),b=i([]),v=_((function(){return t.menuList.some((function(e){return e.children&&e.children.length>0}))})),p=i();u(l,(function(i){return e(a,void 0,void 0,(function(){var e,a;return n(this,(function(n){switch(n.label){case 0:return i?[4,g()]:[3,2];case 1:n.sent(),e=p.value,t.menuWrapperCss&&Object.keys(t.menuWrapperCss).map((function(n){e.style.setProperty("--menu-"+n,t.menuWrapperCss&&t.menuWrapperCss[n])})),t.menuItemCss&&(Object.keys(t.menuItemCss).map((function(n){e.style.setProperty("--menu-item-"+n,t.menuItemCss&&t.menuItemCss[n])})),a=(a=t.menuItemCss.arrowSize.match(/\d+/))&&~~a[0]||10,e.style.setProperty("--menu-item-arrowRealSize",a/2+"px")),n.label=2;case 2:return[2]}}))}))}));var h=function(e,n,t,a){return e.map((function(e){return e.children&&(e.children=h(e.children,n,t,a)),e.label&&"function"==typeof e.label&&(e.label=e.label(a,n,t)),e.tips&&"function"==typeof e.tips&&(e.tips=e.tips(a,n,t)),e.hidden&&"function"==typeof e.hidden&&(e.hidden=e.hidden(a,n,t)),e.disabled&&"function"==typeof e.disabled&&(e.disabled=e.disabled(a,n,t)),e}))};return{subLeft:o,subTop:m,hoverFlag:r,menuTop:d,menuLeft:s,showMenu:l,clickDomEl:c,calcMenuList:b,hasSubMenu:v,MenuWrapper:p,handleMenuItemClick:function(e){e.fn&&"function"==typeof e.fn&&!e.disabled&&e.fn(t.params,c.value,t.el),l.value=!1},handleSubMenuItemClick:function(e){e.fn&&"function"==typeof e.fn&&!e.disabled&&(e.fn(t.params,c.value,t.el),r.value=!1),l.value=!1},handleMenuMouseEnter:function(e,n){if(n.children&&!n.disabled){r.value=!0;var t=e.currentTarget;if(!t)return;var a=t.offsetWidth,i=t.querySelector(".__menu__sub__wrapper");if(!i)return;var _=i.offsetWidth,u=i.offsetHeight,d=window.innerWidth,s=window.innerHeight,l=t.getBoundingClientRect(),c=l.top,b=l.left;o.value=b+a+_>d-5?b-_+5:b+a,m.value=c+u>s-5?s-u:c+5}},show:function(i,_){return void 0===i&&(i=0),void 0===_&&(_=0),e(a,void 0,void 0,(function(){var e,a,u,o,m;return n(this,(function(n){switch(n.label){case 0:return c.value=document.elementFromPoint(i-1,_-1),t.menuHiddenFn?l.value=!t.menuHiddenFn(t.params,c.value,t.el):l.value=!0,l.value?(b.value=S(t.menuList),b.value=h(b.value,c.value,t.el,t.params),[4,g()]):[2];case 1:return n.sent(),e=window.innerWidth,a=window.innerHeight,u=p.value,o=u.offsetHeight,m=t.menuWidth||200,s.value=i+m+1>e?e-m-5:i+1,d.value=_+o+1>a?a-o-5:_+1,[2]}}))}))},close:function(){l.value=!1}}}});const M=l("data-v-3d21bc0a");c("data-v-3d21bc0a");const z={key:0,class:"__menu__item-icon"},I={class:"__menu__item-label"},L={class:"__menu__item-tips"},T={class:"__menu__item-arrow-after"},W={class:"__menu__sub__item-label"},F={class:"__menu__sub__item-tips"};b();const B=M(((e,n,t,a,i,_)=>(v(),o(s,{to:"body",disabled:!e.appendToBody},[e.showMenu?(v(),o("div",{key:0,ref:"MenuWrapper",class:"__menu__wrapper",style:{width:`${e.menuWidth}px`,top:`${e.menuTop}px`,left:`${e.menuLeft}px`}},[(v(!0),o(m,null,r(e.calcMenuList,((n,t)=>(v(),o(m,null,[n.hidden||n.line?d("v-if",!0):(v(),o("div",{key:t,class:["__menu__item",{disabled:n.disabled}],onMousedown:p((t=>e.handleMenuItemClick(n)),["stop"]),onMouseenter:t=>e.handleMenuMouseEnter(t,n)},[e.hasIcon?(v(),o("span",z,["font-icon"===e.iconType?h((v(),o("i",{key:0,class:n.icon},null,2)),[[f,n.icon]]):d("v-if",!0)])):d("v-if",!0),w("span",I,y(n.label),1),w("span",L,y(n.tips||""),1),e.hasSubMenu?(v(),o("span",{key:1,class:["__menu__item-arrow",{show:e.hasSubMenu&&n.children}],style:{width:e.menuItemCss.arrowSize,height:e.menuItemCss.arrowSize}},[h(w("span",T,null,512),[[f,e.hasSubMenu&&n.children]])],6)):d("v-if",!0),n.children&&n.children.length>0?h((v(),o("div",{key:2,class:"__menu__sub__wrapper",style:{top:`${e.subTop}px`,left:`${e.subLeft}px`}},[(v(!0),o(m,null,r(n.children,((n,t)=>(v(),o(m,null,[n.hidden||n.line?d("v-if",!0):(v(),o("div",{key:t,class:["__menu__sub__item",{disabled:n.disabled}],onMousedown:p((t=>e.handleSubMenuItemClick(n)),["stop"])},[w("span",W,y(n.label),1),w("span",F,y(n.tips||""),1)],42,["onMousedown"])),n.line?(v(),o("div",{key:t,class:"__menu__line"})):d("v-if",!0)],64)))),256))],4)),[[f,e.hoverFlag]]):d("v-if",!0)],42,["onMousedown","onMouseenter"])),n.line?(v(),o("div",{key:t,class:"__menu__line"})):d("v-if",!0)],64)))),256))],4)):d("v-if",!0)],8,["disabled"]))));var E;function j(e){var n,t,a="__mouse__menu__container";t=document.querySelector("."+a)?document.querySelector("."+a):function(e,n,t){var a=document.createElement(e);return a.setAttribute("class",n),t&&(a.innerText=t),a}("div",a);var i=x(k,e);return C(i,t),document.body.appendChild(t),null===(n=i.component)||void 0===n?void 0:n.proxy}!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===t&&a.firstChild?a.insertBefore(i,a.firstChild):a.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".__menu__mask[data-v-3d21bc0a] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  z-index: 999;\n}\n.__menu__wrapper[data-v-3d21bc0a] {\n  --menu-background: #c8f2f0;\n  --menu-boxShadow: 0 1px 5px #888;\n  --menu-padding: 5px 0;\n  --menu-borderRadius: 0;\n  --menu-item-height: 30px;\n  --menu-item-padding: 0 10px;\n  --menu-item-iconSize: 20px;\n  --menu-item-iconFontSize: 14px;\n  --menu-item-iconColor: #484852;\n  --menu-item-labelColor: #484852;\n  --menu-item-labelFontSize: 14px;\n  --menu-item-tipsColor: #889;\n  --menu-item-tipsFontSize: 12px;\n  --menu-item-arrowColor: #484852;\n  --menu-item-disabledColor: #bcc;\n  --menu-item-hoverBackground: rgba(255, 255, 255, 0.8);\n  --menu-item-hoverIconColor: inherit;\n  --menu-item-hoverLabelColor: inherit;\n  --menu-item-hoverTipsColor: inherit;\n  --menu-item-hoverArrowColor: inherit;\n  --menu-lineColor: #ccc;\n  --menu-lineMargin: 5px 0;\n}\n.__menu__wrapper[data-v-3d21bc0a] {\n  position: absolute;\n  width: 200px;\n  background: var(--menu-background);\n  box-shadow: var(--menu-boxShadow);\n  padding: var(--menu-padding);\n  border-radius: var(--menu-borderRadius);\n  z-index: 99999;\n}\n.__menu__line[data-v-3d21bc0a],\n.__menu__sub__line[data-v-3d21bc0a] {\n  border-top: 1px solid var(--menu-lineColor);\n  margin: var(--menu-lineMargin);\n}\n.__menu__item[data-v-3d21bc0a],\n.__menu__sub__item[data-v-3d21bc0a] {\n  display: flex;\n  height: var(--menu-item-height);\n  line-height: var(--menu-item-height);\n  align-items: center;\n  cursor: pointer;\n  padding: 0 10px;\n}\n.__menu__item .__menu__item-icon[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon[data-v-3d21bc0a] {\n  color: var(--menu-item-iconColor);\n  width: var(--menu-item-iconSize);\n  height: var(--menu-item-iconSize);\n  line-height: var(--menu-item-iconSize);\n}\n.__menu__item .__menu__item-icon i[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon i[data-v-3d21bc0a] {\n  font-size: var(--menu-item-iconFontSize);\n}\n.__menu__item .__menu__item-label[data-v-3d21bc0a],\n.__menu__item .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-label[data-v-3d21bc0a],\n.__menu__sub__item .__menu__sub__item-label[data-v-3d21bc0a] {\n  width: 100%;\n  max-height: 100%;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  flex: 1;\n  font-size: var(--menu-item-labelFontSize);\n  color: var(--menu-item-labelColor);\n  margin-right: 5px;\n  overflow: hidden;\n}\n.__menu__item .__menu__item-tips[data-v-3d21bc0a],\n.__menu__item .__menu__sub__item-tips[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-tips[data-v-3d21bc0a],\n.__menu__sub__item .__menu__sub__item-tips[data-v-3d21bc0a] {\n  font-size: var(--menu-item-tipsFontSize);\n  color: var(--menu-item-tipsColor);\n}\n.__menu__item .__menu__item-arrow[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-arrow[data-v-3d21bc0a] {\n  width: 10px;\n  height: 10px;\n  margin-left: 5px;\n  position: relative;\n}\n.__menu__item.disabled[data-v-3d21bc0a],\n.__menu__sub__item.disabled[data-v-3d21bc0a] {\n  cursor: not-allowed;\n}\n.__menu__item.disabled .__menu__item-icon[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__item-label[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__item-tips[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__sub__item-tips[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-icon[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-label[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-tips[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__sub__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-disabledColor);\n}\n.__menu__item.disabled .__menu__item-arrow .__menu__item-arrow-after[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-arrow .__menu__item-arrow-after[data-v-3d21bc0a] {\n  border-left: var(--menu-item-arrowRealSize) solid var(--menu-item-disabledColor);\n}\n.__menu__item[data-v-3d21bc0a]:not(.disabled):hover {\n  background: var(--menu-item-hoverBackground);\n}\n.__menu__item:not(.disabled):hover .__menu__item-icon[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverIconColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-label[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverLabelColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverTipsColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-arrow[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverArrowColor);\n}\n.__menu__sub__item[data-v-3d21bc0a]:not(.disabled):hover {\n  background: var(--menu-item-hoverBackground);\n}\n.__menu__sub__item:not(.disabled):hover .__menu__sub__item-label[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverLabelColor);\n}\n.__menu__sub__item:not(.disabled):hover .__menu__sub__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverTipsColor);\n}\n.__menu__item-icon[data-v-3d21bc0a] {\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  line-height: 20px;\n  margin-right: 4px;\n}\n.__menu__item-arrow.show .__menu__item-arrow-after[data-v-3d21bc0a] {\n  position: absolute;\n  width: 0;\n  height: 0;\n  left: 8px;\n  border-left: var(--menu-item-arrowRealSize) solid var(--menu-item-arrowColor);\n  border-top: var(--menu-item-arrowRealSize) solid transparent;\n  border-bottom: var(--menu-item-arrowRealSize) solid transparent;\n}\n.__menu__sub__wrapper[data-v-3d21bc0a] {\n  position: fixed;\n  visibility: hidden;\n  width: 200px;\n  background: var(--menu-background);\n  box-shadow: var(--menu-boxShadow);\n  padding: var(--menu-padding);\n  border-radius: var(--menu-borderRadius);\n}\n.__menu__item:hover .__menu__sub__wrapper[data-v-3d21bc0a] {\n  visibility: visible;\n}"),k.render=B,k.__scopeId="data-v-3d21bc0a",k.__file="packages/mouse-menu/mouse-menu.vue",k.install=function(e){e.component(k.name,k)};var A={mounted:function(e,n){var a=n.value,i=t({menuWidth:200,menuList:[],hasIcon:!1,iconType:"font-icon"},a),_=t({},a.menuWrapperCss),u=t({arrowSize:"10px"},a.menuItemCss);if(!(i.menuList.length>0))throw new Error("At least set one menu list!");E=function(n){var t=j({el:e,menuList:i.menuList,params:i.params,menuWidth:i.width,hasIcon:i.hasIcon,iconType:i.iconType,menuHiddenFn:i.menuHiddenFn,menuWrapperCss:_,menuItemCss:u}),a=function(e){e.preventDefault();var n=e.x,a=e.y;t.show(n,a)};2===n.button?(n.stopPropagation(),document.addEventListener("contextmenu",a),document.onmousedown=function(){document.removeEventListener("contextmenu",a),t.close()}):t.close()},e.addEventListener("mousedown",E)},unmounted:function(e){e.removeEventListener("mousedown",E)}};export{A as M};
