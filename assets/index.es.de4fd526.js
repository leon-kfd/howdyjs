class t{constructor({el:t,options:e}){t instanceof HTMLElement?this.el=t:this.el=document.querySelector(t),this.options=Object.assign({direction:"y",scrollBarWidth:6,scrollBarOffsetX:0,scrollBarOffsetY:0,scrollBarThumbColor:"#aab",scrollBarThumbBorderRadius:!0,scrollBarTrackColor:"transparent",enableTrackClickScroll:!0,scrollSpeed:20,dragScroll:!1,thumbShow:"always"},e),this.directionArr="all"===this.options.direction?["x","y"]:["x","y"].includes(this.options.direction)?[this.options.direction]:["y"],this.timer=null,this.el.$scroll=this}init(t=0,e=0){this.scrollWrapper=document.createElement("div"),this.scrollWrapper.style.cssText=`position: absolute;top:0;left:0;bottom:0;right:0;transform:translate(${t}px,${e}px)`,this.scrollWrapper.setAttribute("class","scroll__wrapper"),this.el.appendChild(this.scrollWrapper),this.el.style.position="relative",this.el.style.overflow="hidden",this.directionArr.map((t=>{this.createScrollBarTrack(t)})),this.options.dragScroll&&this.setDragScroll(this.el,this.directionArr),"hover"===this.options.thumbShow&&this.setDisplayForHover(this.el)}createScrollBarTrack(t){const e="y"===t;let{scrollBarWidth:o,scrollBarOffsetX:s,scrollBarOffsetY:r,scrollBarThumbColor:l,scrollBarThumbHoverColor:n,scrollBarThumbBorderRadius:i,scrollBarTrackColor:c,enableTrackClickScroll:a,scrollSpeed:d}=this.options;const u=l.includes("gradient");i=i?o/2:0;const p=document.createElement("div");p.setAttribute("direction",t);const m=e?`position: absolute;right: 0;top: 0;height: 100%; width: ${o+2*s}px;background: ${c};`:`position: absolute;left: 0;bottom: 0;width: 100%; height: ${o+2*s}px;background: ${c};`;p.style.cssText=m,p.setAttribute("class",`scroll__track_${t}`),this.scrollWrapper&&this.scrollWrapper.appendChild(p);const h=document.createElement("div");let y=e?`position: relative;top: 0;right: 0;width: ${o+2*s}px;padding: ${r}px ${s}px;box-sizing:border-box;cursor: pointer;`:`position: relative;bottom: 0;left: 0;height: ${o+2*s}px;padding: ${s}px ${r}px;box-sizing:border-box;cursor: pointer;`;const f=document.createElement("div");let b=`width: 100%;height:100%;border-radius: ${i}px;`;b+=u?`background-image: ${l};`:`background: ${l};`;const{offsetHeight:g,scrollHeight:v,offsetWidth:$,scrollWidth:x,scrollTop:w,scrollLeft:T}=this.el,S=e?g:$,_=e?v:x;if(_<=S)return;const W=S/_*S;y+=e?`height: ${W}px;`:`width: ${W}px`,h.style.cssText=y,h.setAttribute("class","scroll__thumb"),f.style.cssText=b,f.setAttribute("class","scroll__thumb_inner"),h.appendChild(f),p.appendChild(h);let B=e?w:T;const k=B/_*S;h.style.transform=e?`translateY(${k}px)`:`translateX(${k}px)`;let E=!1;const A=_-S,C=S-W;let Y,X;e&&(this.el.onmousewheel=function(t){const e=-t.wheelDelta||t.deltaY;return E||(B=e<0?B<-e?0:B+e:B>=A-e?A:B+e,L(p,B/_*S)),!1}),n&&(h.onmouseenter=function(){n&&(f.style.background=n)},h.onmouseleave=function(){f.style.background=l}),h.onmousedown=function(t){t.stopPropagation();const o=t.target.parentNode,s=e?t.clientY:t.clientX,[r]=o.style.transform.match(/\d+(\.\d+)?/)||[0],l=~~r;E=!0,document.onmousemove=function(t){document.body.style.userSelect="none";const{clientY:o,clientX:r}=t;let n=(e?o:r)-s+l;B=n/S*_,B<0?(n=0,B=0):B>A&&(n=C,B=A),L(p,n)},document.onmouseup=function(){E=!1,document.body.style.userSelect="auto",document.onmousemove=null,document.onmouseup=null}},a&&(p.onmousedown=function(t){const o=t.target;if(o){let s=(e?t.clientY-o.getBoundingClientRect().top:t.clientX-o.getBoundingClientRect().left)-W/2;s<0?s=0:s>C&&(s=C),L(o,s)}});const L=(o,s)=>{X&&window.cancelAnimationFrame(X),Y=()=>{let r,l,[n]=o.childNodes[0].style.transform.match(/\d+(\.\d+)?/)||[0];n=~~n,s>n?(n+=d,n<s?(B=n/S*_,r=n,l=!1):(B=n>C?A:s/S*_,r=n>C?C:s,l=!0)):(n-=d,n>s?(B=n/S*_,r=n,l=!1):(B=n<0?0:s/S*_,r=n<0?0:s,l=!0)),this.setTranslate(t,B),h.style.transform=e?`translateY(${r}px)`:`translateX(${r}px)`,e?this.el.scrollTop=B:this.el.scrollLeft=B,l?window.cancelAnimationFrame(X):X=window.requestAnimationFrame(Y)},X=window.requestAnimationFrame(Y)}}update(t=200){null!==this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{if(this.scrollWrapper){const{transform:t}=window.getComputedStyle(this.scrollWrapper),[,,,,e,o]=t.match(/-?\d+\.?\d{0,}/g),s=~~e,r=~~o;this.destroy(),this.init(s,r)}}),t)}destroy(){var t;this.scrollWrapper&&(null===(t=this.scrollWrapper.parentNode)||void 0===t||t.removeChild(this.scrollWrapper),this.scrollWrapper=null),this.el.mouseenterEvent&&this.el.addEventListener("mouseenter",this.el.mouseenterEvent),this.el.mouseleaveEvent&&this.el.addEventListener("mouseleave",this.el.mouseleaveEvent)}setTranslate(t,e){if(this.scrollWrapper){const{transform:o}=window.getComputedStyle(this.scrollWrapper),[s,r,l,n,i,c]=o.match(/-?\d+\.?\d{0,}/g);"x"===t?this.scrollWrapper.style.transform=`matrix(${s},${r},${l},${n},${e},${c})`:"y"===t&&(this.scrollWrapper.style.transform=`matrix(${s},${r},${l},${n},${i},${e})`)}}setDisplayForHover(t){const e=Array.from(t.querySelectorAll(".scroll__thumb"));e.map((t=>{t.style.cssText=t.style.cssText+"opacity: 0;transition: opacity .4s ease-in-out"})),t.mouseenterEvent=function(){e.map((t=>{t.style.opacity="1"}))},t.mouseleaveEvent=function(){e.map((t=>{t.style.opacity="0"}))},t.addEventListener("mouseenter",t.mouseenterEvent),t.addEventListener("mouseleave",t.mouseleaveEvent)}setDragScroll(t,e){t.onmousedown=function(o){const{scrollTop:s,scrollLeft:r,scrollHeight:l,offsetHeight:n,scrollWidth:i,offsetWidth:c}=t,{clientX:a,clientY:d}=o,[u,p]=[i-c,l-n],[m,h]=[c-c/i*c,n-n/l*n];document.body.style.userSelect="none",document.body.style.cursor="pointer",document.onmousemove=function(o){const{clientX:y,clientY:f}=o;let[b,g]=[a-y+r,d-f+s],[v,$]=[b/i*c,g/l*n];b<0?(v=0,b=0):b>u&&(v=m,b=u),g<0?($=0,g=0):g>p&&($=h,g=p),t.querySelector(".scroll__wrapper").style.transform=`translate(${b}px, ${g}px)`,e.includes("x")&&(t.querySelector(".scroll__track_x .scroll__thumb").style.transform=`translateX(${v}px)`),e.includes("y")&&(t.querySelector(".scroll__track_y .scroll__thumb").style.transform=`translateY(${$}px)`),t.scrollTop=g,t.scrollLeft=b},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,document.body.style.userSelect="default",document.body.style.cursor="default"}}}}const e=(e,o,s)=>{const{arg:r,value:l}=o,n=s||{};if(!/(Android|iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)){const o=Object.assign(Object.assign(Object.assign({},n),l),{direction:r});new t({el:e,options:o}).init()}},o=t=>{t.$scroll&&t.$scroll.destroy()},s={install:(t,s)=>{t.directive("scroll",{mounted:(t,o)=>e(t,o,s),unmounted:o,inserted:(t,o)=>e(t,o,s),unbind:o})},mounted:(t,o)=>e(t,o),unmounted:o,inserted:(t,o)=>e(t,o),unbind:o};export{s as S};
