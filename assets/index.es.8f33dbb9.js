class G{constructor({el:t,options:e}){t instanceof HTMLElement?this.el=t:this.el=document.querySelector(t),this.options=Object.assign({direction:"y",scrollBarWidth:6,scrollBarOffsetX:0,scrollBarOffsetY:0,scrollBarThumbColor:"#aab",scrollBarThumbBorderRadius:!0,scrollBarTrackColor:"transparent",enableTrackClickScroll:!0,scrollSpeed:20,dragScroll:!1,thumbShow:"always"},e),this.directionArr=this.options.direction==="all"?["x","y"]:["x","y"].includes(this.options.direction)?[this.options.direction]:["y"],this.timer=null,this.el.$scroll=this}init(t=0,e=0){this.scrollWrapper=document.createElement("div"),this.scrollWrapper.style.cssText=`position: absolute;top:0;left:0;bottom:0;right:0;transform:translate(${t}px,${e}px)`,this.scrollWrapper.setAttribute("class","scroll__wrapper"),this.el.appendChild(this.scrollWrapper),this.el.style.position="relative",this.el.style.overflow="hidden",this.directionArr.map(o=>{this.createScrollBarTrack(o)}),this.options.dragScroll&&this.setDragScroll(this.el,this.directionArr),this.options.thumbShow==="hover"&&this.setDisplayForHover(this.el)}createScrollBarTrack(t){const e=t==="y";let{scrollBarWidth:o,scrollBarOffsetX:s,scrollBarOffsetY:h,scrollBarThumbColor:n,scrollBarThumbHoverColor:c,scrollBarThumbBorderRadius:b,scrollBarTrackColor:y,enableTrackClickScroll:H,scrollSpeed:W}=this.options;const A=n.includes("gradient");b=b?o/2:0;const p=document.createElement("div");p.setAttribute("direction",t);const M=e?`position: absolute;right: 0;top: 0;height: 100%; width: ${o+s*2}px;background: ${y};`:`position: absolute;left: 0;bottom: 0;width: 100%; height: ${o+s*2}px;background: ${y};`;p.style.cssText=M,p.setAttribute("class",`scroll__track_${t}`),this.scrollWrapper&&this.scrollWrapper.appendChild(p);const f=document.createElement("div");let E=e?`position: relative;top: 0;right: 0;width: ${o+s*2}px;padding: ${h}px ${s}px;box-sizing:border-box;cursor: pointer;`:`position: relative;bottom: 0;left: 0;height: ${o+s*2}px;padding: ${s}px ${h}px;box-sizing:border-box;cursor: pointer;`;const T=document.createElement("div");let _=`width: 100%;height:100%;border-radius: ${b}px;`;A?_+=`background-image: ${n};`:_+=`background: ${n};`;const{offsetHeight:g,scrollHeight:S,offsetWidth:w,scrollWidth:C,scrollTop:z,scrollLeft:j}=this.el,d=e?g:w,x=e?S:C;if(x<=d)return;const Y=d/x*d;E+=e?`height: ${Y}px;`:`width: ${Y}px`,f.style.cssText=E,f.setAttribute("class","scroll__thumb"),T.style.cssText=_,T.setAttribute("class","scroll__thumb_inner"),f.appendChild(T),p.appendChild(f);let r=e?z:j;const P=r/x*d;f.style.transform=e?`translateY(${P}px)`:`translateX(${P}px)`;let q=!1;const B=x-d,v=d-Y;e&&(this.el.onmousewheel=function(a){const l=-a.wheelDelta||a.deltaY;return q||(r=l<0?r<-l?0:r+l:r>=B-l?B:r+l,D(p,r/x*d)),!1}),c&&(f.onmouseenter=function(){c&&(T.style.background=c)},f.onmouseleave=function(){T.style.background=n}),f.onmousedown=function(a){a.stopPropagation();const l=a.target.parentNode,$=e?a.clientY:a.clientX,[u]=l.style.transform.match(/\d+(\.\d+)?/)||[0],i=~~u;q=!0,document.onmousemove=function(I){document.body.style.userSelect="none";const{clientY:R,clientX:N}=I;let L=(e?R:N)-$+i;r=L/d*x,r<0?(L=0,r=0):r>B&&(L=v,r=B),D(p,L)},document.onmouseup=function(){q=!1,document.body.style.userSelect="auto",document.onmousemove=null,document.onmouseup=null}},H&&(p.onmousedown=function(a){const l=a.target;if(l){let u=(e?a.clientY-l.getBoundingClientRect().top:a.clientX-l.getBoundingClientRect().left)-Y/2;u<0?u=0:u>v&&(u=v),D(l,u)}});let F,k;const D=(a,l)=>{k&&window.cancelAnimationFrame(k),F=()=>{let $,u,[i]=a.childNodes[0].style.transform.match(/\d+(\.\d+)?/)||[0];i=~~i,l>i?(i+=W,i<l?(r=i/d*x,$=i,u=!1):(r=i>v?B:l/d*x,$=i>v?v:l,u=!0)):(i-=W,i>l?(r=i/d*x,$=i,u=!1):(r=i<0?0:l/d*x,$=i<0?0:l,u=!0)),this.setTranslate(t,r),f.style.transform=e?`translateY(${$}px)`:`translateX(${$}px)`,e?this.el.scrollTop=r:this.el.scrollLeft=r,u?window.cancelAnimationFrame(k):k=window.requestAnimationFrame(F)},k=window.requestAnimationFrame(F)}}update(t=200){this.timer!==null&&clearTimeout(this.timer),this.timer=setTimeout(()=>{if(this.scrollWrapper){const{transform:e}=window.getComputedStyle(this.scrollWrapper),[,,,,o,s]=e.match(/-?\d+\.?\d{0,}/g),h=~~o,n=~~s;this.destroy(),this.init(h,n)}},t)}destroy(){var t;this.scrollWrapper&&((t=this.scrollWrapper.parentNode)===null||t===void 0||t.removeChild(this.scrollWrapper),this.scrollWrapper=null),this.el.mouseenterEvent&&this.el.addEventListener("mouseenter",this.el.mouseenterEvent),this.el.mouseleaveEvent&&this.el.addEventListener("mouseleave",this.el.mouseleaveEvent)}setTranslate(t,e){if(this.scrollWrapper){const{transform:o}=window.getComputedStyle(this.scrollWrapper),[s,h,n,c,b,y]=o.match(/-?\d+\.?\d{0,}/g);t==="x"?this.scrollWrapper.style.transform=`matrix(${s},${h},${n},${c},${e},${y})`:t==="y"&&(this.scrollWrapper.style.transform=`matrix(${s},${h},${n},${c},${b},${e})`)}}setDisplayForHover(t){const e="opacity: 0;transition: opacity .4s ease-in-out",o=Array.from(t.querySelectorAll(".scroll__thumb"));o.map(s=>{s.style.cssText=s.style.cssText+e}),t.mouseenterEvent=function(){o.map(s=>{s.style.opacity="1"})},t.mouseleaveEvent=function(){o.map(s=>{s.style.opacity="0"})},t.addEventListener("mouseenter",t.mouseenterEvent),t.addEventListener("mouseleave",t.mouseleaveEvent)}setDragScroll(t,e){t.onmousedown=function(o){const{scrollTop:s,scrollLeft:h,scrollHeight:n,offsetHeight:c,scrollWidth:b,offsetWidth:y}=t,{clientX:H,clientY:W}=o,[A,p]=[b-y,n-c],[M,f]=[y-y/b*y,c-c/n*c];document.body.style.userSelect="none",document.body.style.cursor="pointer",document.onmousemove=function(E){const{clientX:T,clientY:_}=E;let[g,S]=[H-T+h,W-_+s],[w,C]=[g/b*y,S/n*c];g<0?(w=0,g=0):g>A&&(w=M,g=A),S<0?(C=0,S=0):S>p&&(C=f,S=p),t.querySelector(".scroll__wrapper").style.transform=`translate(${g}px, ${S}px)`,e.includes("x")&&(t.querySelector(".scroll__track_x .scroll__thumb").style.transform=`translateX(${w}px)`),e.includes("y")&&(t.querySelector(".scroll__track_y .scroll__thumb").style.transform=`translateY(${C}px)`),t.scrollTop=S,t.scrollLeft=g},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,document.body.style.userSelect="default",document.body.style.cursor="default"}}}}const X=(m,t,e)=>{const{arg:o,value:s}=t,h=/(Android|iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent),n=e||{};if(!h){const c=Object.assign(Object.assign(Object.assign({},n),s),{direction:o});new G({el:m,options:c}).init()}},O=m=>{m.$scroll&&m.$scroll.destroy()},J={mounted:(m,t)=>X(m,t),unmounted:O,inserted:(m,t)=>X(m,t),unbind:O,install:(m,t)=>{m.directive("scroll",{mounted:(e,o)=>X(e,o,t),unmounted:O,inserted:(e,o)=>X(e,o,t),unbind:O})}};export{J as S};
