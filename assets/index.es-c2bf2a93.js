import{T as C}from"./index.es-0a1a5ce2.js";var E=Object.defineProperty,y=(e,t,o)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,r=(e,t,o)=>(y(e,typeof t!="symbol"?t+"":t,o),o);class T extends C{constructor({el:t,options:o}){super({el:t,options:{adsorb:0,adsorbOffset:0,isAbsolute:!1,positionMode:1,...o}}),r(this,"arrowCtx",null),r(this,"controlOptions"),r(this,"arrowStartX",0),r(this,"arrowStartY",0),r(this,"elWidth",0),r(this,"elHeight",0),r(this,"resizeFlag",!1),r(this,"arrowMouseDownEvent",i=>{if(typeof this.controlOptions.disabled=="function"&&this.controlOptions.disabled())return;const s=this.isTouch?i.changedTouches[0].clientX:i.x,n=this.isTouch?i.changedTouches[0].clientY:i.y,{width:w,height:f,left:h,top:l}=this.el.getBoundingClientRect(),{width:g,height:v}=this.parent.getBoundingClientRect();this.arrowStartX=s,this.arrowStartY=n,this.elWidth=w,this.elHeight=f,this.resizeFlag=!0;let a,d;this.controlOptions.isAbsolute?(a=g-this.el.offsetLeft-this.borderInfo[1]-this.borderInfo[3],d=v-this.el.offsetTop-this.borderInfo[0]-this.borderInfo[2]):(a=window.innerWidth-h,d=window.innerHeight-l),setTimeout(()=>{this.isDrag=!1}),this.el.style.left=`${this.controlOptions.isAbsolute?this.el.offsetLeft:h}px`,this.el.style.top=`${this.controlOptions.isAbsolute?this.el.offsetTop:l}px`,this.el.style.right="auto",this.el.style.bottom="auto",this.emitControlEvent("tocontrolstart"),this.isTouch?(document.ontouchmove=c=>{if(!this.resizeFlag||!c.changedTouches)return;const{clientX:x,clientY:b}=c.changedTouches[0];this.el.style.width=`${Math.min(this.elWidth+x-this.arrowStartX,a)}px`,this.el.style.height=`${Math.min(this.elHeight+b-this.arrowStartY,d)}px`,this.emitControlEvent("tocontrolmove")},document.ontouchend=()=>{this.setPosition(),this.resizeFlag=!1,document.ontouchmove=null,document.ontouchend=null,this.emitControlEvent("tocontrolend")}):(document.onmousemove=c=>{if(!this.resizeFlag)return;const{x,y:b}=c;this.el.style.width=`${Math.min(this.elWidth+x-this.arrowStartX,a)}px`,this.el.style.height=`${Math.min(this.elHeight+b-this.arrowStartY,d)}px`,this.emitControlEvent("tocontrolmove")},document.onmouseup=()=>{this.setPosition(),this.resizeFlag=!1,document.onmousemove=null,document.onmouseup=null,this.emitControlEvent("tocontrolend")})}),this.controlOptions=o||{},this.initControl()}initControl(){var t;this.arrowCtx=this.createResizeArrow((t=this.controlOptions)==null?void 0:t.arrowOptions),this.el.appendChild(this.arrowCtx)}updateArrow(){var t;this.arrowCtx&&this.el.contains(this.arrowCtx)&&this.el.removeChild(this.arrowCtx),this.arrowCtx=this.createResizeArrow((t=this.controlOptions)==null?void 0:t.arrowOptions),this.el.appendChild(this.arrowCtx)}createResizeArrow(t){const o=typeof this.controlOptions.disabled=="function"&&this.controlOptions.disabled(),i={size:8,lineWidth:2,lineColor:"#9a9a9a",padding:2,...t},s=document.createElement("div");s.style.cssText=`
      position: absolute;
      right: 0; 
      bottom: 0;
      padding: ${i.padding}px;
      cursor: se-resize;
      background: ${i.background||"none"};
      display: ${o?"none":"block"}
    `,s.className="to-control-arrow";const n=document.createElement("div");return n.style.cssText=`
      width: ${i.size}px;
      height: ${i.size}px;
      border-bottom: ${i.lineWidth}px solid ${i.lineColor};
      border-right: ${i.lineWidth}px solid ${i.lineColor};
    `,n.className="to-control-arrow-inner",s.appendChild(n),this.isTouch?s.addEventListener("touchstart",this.arrowMouseDownEvent):s.addEventListener("mousedown",this.arrowMouseDownEvent),s}destroyControl(){var t,o;this.destroy(),this.isTouch?(t=this.arrowCtx)==null||t.removeEventListener("touchstart",this.arrowMouseDownEvent):(o=this.arrowCtx)==null||o.removeEventListener("mousedown",this.arrowMouseDownEvent)}emitControlEvent(t){const o=document.createEvent("HTMLEvents");o.initEvent(t,!1,!1);const{left:i,top:s,right:n,bottom:w,width:f,height:h,maxX:l,maxY:g}=this;o.left=i,o.top=s,o.width=f,o.height=h,o.maxX=l,o.maxY=g,o.right=n,o.bottom=w,this.el.dispatchEvent(o)}}const u=(e,t,o)=>{const{value:i}=t,n={...o||{},...i};e.$toControl=new T({el:e,options:n})},p=e=>{e.$toControl&&e.$toControl.updateArrow()},m=e=>{e.$toControl&&e.$toControl.destroy()},O={mounted:(e,t)=>u(e,t),unmounted:m,beforeUpdate:p,inserted:(e,t)=>u(e,t),unbind:m,update:p,install:(e,t)=>{e.directive("to-control",{mounted:(o,i)=>u(o,i,t),unmounted:m,beforeUpdate:p,inserted:(o,i)=>u(o,i,t),unbind:m,update:p})}};export{T,O as a};
