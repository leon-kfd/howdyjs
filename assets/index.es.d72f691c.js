import{T as x}from"./index.es.5eac8f7c.js";class C extends x{constructor({el:t,options:o}){super({el:t,options:Object.assign({adsorb:0,adsorbOffset:0,isAbsolute:!1,positionMode:1},o)});this.arrowCtx=null,this.arrowStartX=0,this.arrowStartY=0,this.elWidth=0,this.elHeight=0,this.resizeFlag=!1,this.arrowMouseDownEvent=e=>{if(typeof this.controlOptions.disabled=="function"&&this.controlOptions.disabled())return;const s=this.isTouch?e.changedTouches[0].clientX:e.x,n=this.isTouch?e.changedTouches[0].clientY:e.y,{width:m,height:w,left:r,top:h}=this.el.getBoundingClientRect(),{width:g,height:b}=this.parent.getBoundingClientRect();this.arrowStartX=s,this.arrowStartY=n,this.elWidth=m,this.elHeight=w,this.resizeFlag=!0;let l,a;this.controlOptions.isAbsolute?(l=g-this.el.offsetLeft-this.borderInfo[1]-this.borderInfo[3],a=b-this.el.offsetTop-this.borderInfo[0]-this.borderInfo[2]):(l=window.innerWidth-r,a=window.innerHeight-h),setTimeout(()=>{this.isDrag=!1}),this.el.style.left=`${this.controlOptions.isAbsolute?this.el.offsetLeft:r}px`,this.el.style.top=`${this.controlOptions.isAbsolute?this.el.offsetTop:h}px`,this.el.style.right="auto",this.el.style.bottom="auto",this.emitControlEvent("tocontrolstart"),this.isTouch?(document.ontouchmove=d=>{if(!this.resizeFlag||!d.changedTouches)return;const{clientX:v,clientY:f}=d.changedTouches[0];this.el.style.width=`${Math.min(this.elWidth+v-this.arrowStartX,l)}px`,this.el.style.height=`${Math.min(this.elHeight+f-this.arrowStartY,a)}px`,this.emitControlEvent("tocontrolmove")},document.ontouchend=()=>{this.setPosition(),this.resizeFlag=!1,document.ontouchmove=null,document.ontouchend=null,this.emitControlEvent("tocontrolend")}):(document.onmousemove=d=>{if(!this.resizeFlag)return;const{x:v,y:f}=d;this.el.style.width=`${Math.min(this.elWidth+v-this.arrowStartX,l)}px`,this.el.style.height=`${Math.min(this.elHeight+f-this.arrowStartY,a)}px`,this.emitControlEvent("tocontrolmove")},document.onmouseup=()=>{this.setPosition(),this.resizeFlag=!1,document.onmousemove=null,document.onmouseup=null,this.emitControlEvent("tocontrolend")})},this.controlOptions=o||{},this.initControl()}initControl(){var t;this.arrowCtx=this.createResizeArrow((t=this.controlOptions)===null||t===void 0?void 0:t.arrowOptions),this.el.appendChild(this.arrowCtx)}updateArrow(){var t;this.arrowCtx&&this.el.removeChild(this.arrowCtx),this.arrowCtx=this.createResizeArrow((t=this.controlOptions)===null||t===void 0?void 0:t.arrowOptions),this.el.appendChild(this.arrowCtx)}createResizeArrow(t){const o=typeof this.controlOptions.disabled=="function"&&this.controlOptions.disabled(),e=Object.assign({size:8,lineWidth:2,lineColor:"#9a9a9a",padding:2},t),s=document.createElement("div"),n=`
      position: absolute;
      right: ${e.padding}px; 
      bottom: ${e.padding}px;
      width: ${e.size}px;
      height: ${e.size}px;
      border-bottom: ${e.lineWidth}px solid ${e.lineColor};
      border-right: ${e.lineWidth}px solid ${e.lineColor};
      cursor: se-resize;
      background: ${e.background||"none"};
      display: ${o?"none":"block"}
    `;return s.className="to-control-arrow",s.style.cssText=n,this.isTouch?s.addEventListener("touchstart",this.arrowMouseDownEvent):s.addEventListener("mousedown",this.arrowMouseDownEvent),s}destroyControl(){var t,o;this.destroy(),this.isTouch?(t=this.arrowCtx)===null||t===void 0||t.removeEventListener("touchstart",this.arrowMouseDownEvent):(o=this.arrowCtx)===null||o===void 0||o.removeEventListener("mousedown",this.arrowMouseDownEvent)}emitControlEvent(t){const o=document.createEvent("HTMLEvents");o.initEvent(t,!1,!1);const{left:e,top:s,right:n,bottom:m,width:w,height:r,maxX:h,maxY:g}=this;o.left=e,o.top=s,o.width=w,o.height=r,o.maxX=h,o.maxY=g,o.right=n,o.bottom=m,this.el.dispatchEvent(o)}}const c=(i,t,o)=>{const{value:e}=t,n=Object.assign(Object.assign({},o||{}),e);i.$toControl=new C({el:i,options:n})},u=i=>{i.$toControl&&i.$toControl.updateArrow()},p=i=>{i.$toControl&&i.$toControl.destroy()},E={mounted:(i,t)=>c(i,t),unmounted:p,beforeUpdate:u,inserted:(i,t)=>c(i,t),unbind:p,update:u,install:(i,t)=>{i.directive("to-control",{mounted:(o,e)=>c(o,e,t),unmounted:p,beforeUpdate:u,inserted:(o,e)=>c(o,e,t),unbind:p,update:u})}};export{C as T,E as a};
