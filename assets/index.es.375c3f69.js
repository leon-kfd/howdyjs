import{e,i as n,h as t,k as a,b as i,F as _,s as o,x as u,T as r,w as m,p as d,g as l,o as s,q as c,n as b,B as v,f as p,t as h,E as f,G as w,D as y}from"./vendor.f3fe9e6c.js";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var g=function(){return(g=Object.assign||function(e){for(var n,t=1,a=arguments.length;t<a;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function x(e,n,t,a){return new(t||(t=Promise))((function(i,_){function o(e){try{r(a.next(e))}catch(n){_(n)}}function u(e){try{r(a.throw(e))}catch(n){_(n)}}function r(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,u)}r((a=a.apply(e,n||[])).next())}))}function C(e,n){var t,a,i,_,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return _={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_;function u(_){return function(u){return function(_){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,a&&(i=2&_[0]?a.return:_[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,_[1])).done)return i;switch(a=0,i&&(_=[2&_[0],i.value]),_[0]){case 0:case 1:i=_;break;case 4:return o.label++,{value:_[1],done:!1};case 5:o.label++,a=_[1],_=[0];continue;case 7:_=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==_[0]&&2!==_[0])){o=0;continue}if(3===_[0]&&(!i||_[1]>i[0]&&_[1]<i[3])){o.label=_[1];break}if(6===_[0]&&o.label<i[1]){o.label=i[1],i=_;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(_);break}i[2]&&o.ops.pop(),o.trys.pop();continue}_=n.call(e,o)}catch(u){_=[6,u],a=0}finally{t=i=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([_,u])}}}var S=function(e){var n=Array.isArray(e)?[]:{};if(e&&"object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&(e[t]&&"object"==typeof e[t]?n[t]=S(e[t]):n[t]=e[t]);return n},k=e({name:"MouseMenu",props:{appendToBody:{type:Boolean,default:!0},menuWidth:{type:Number,default:200},menuList:{type:Array,required:!0},menuHiddenFn:{type:Function},hasIcon:{type:Boolean,default:!1},iconType:{type:String,default:"font-icon"},menuWrapperCss:Object,menuItemCss:Object,el:{type:Object,required:!0},params:{type:[String,Number,Array,Object]}},setup:function(e){var i=this,_=n(0),o=n(0),u=n(!1),r=n(0),m=n(0),d=n(!1),l=n(null),s=n([]),c=t((function(){return e.menuList.some((function(e){return e.children&&e.children.length>0}))})),b=n(10),v=n();a(d,(function(n){return x(i,void 0,void 0,(function(){var t,a,i,_;return C(this,(function(o){switch(o.label){case 0:return n?[4,y()]:[3,2];case 1:o.sent(),t=v.value,e.menuWrapperCss&&Object.keys(e.menuWrapperCss).map((function(n){t.style.setProperty("--menu-"+n,e.menuWrapperCss&&e.menuWrapperCss[n])})),e.menuItemCss&&Object.keys(e.menuItemCss).map((function(n){t.style.setProperty("--menu-item-"+n,e.menuItemCss&&e.menuItemCss[n])})),a=null===(_=null===(i=e.menuItemCss)||void 0===i?void 0:i.arrowSize)||void 0===_?void 0:_.match(/\d+/),b.value=a&&~~a[0]||10,t.style.setProperty("--menu-item-arrowRealSize",b.value/2+"px"),o.label=2;case 2:return[2]}}))}))}));var p=function(e,n,t,a){return e.map((function(e){return e.children&&(e.children=p(e.children,n,t,a)),e.label&&"function"==typeof e.label&&(e.label=e.label(a,n,t)),e.tips&&"function"==typeof e.tips&&(e.tips=e.tips(a,n,t)),e.hidden&&"function"==typeof e.hidden&&(e.hidden=e.hidden(a,n,t)),e.disabled&&"function"==typeof e.disabled&&(e.disabled=e.disabled(a,n,t)),e}))};return{subLeft:_,subTop:o,hoverFlag:u,menuTop:r,menuLeft:m,showMenu:d,clickDomEl:l,calcMenuList:s,arrowSize:b,hasSubMenu:c,MenuWrapper:v,handleMenuItemClick:function(n){n.fn&&"function"==typeof n.fn&&!n.disabled&&n.fn(e.params,l.value,e.el),d.value=!1},handleSubMenuItemClick:function(n){n.fn&&"function"==typeof n.fn&&!n.disabled&&(n.fn(e.params,l.value,e.el),u.value=!1),d.value=!1},handleMenuMouseEnter:function(e,n){if(n.children&&!n.disabled){u.value=!0;var t=e.currentTarget;if(!t)return;var a=t.offsetWidth,i=t.querySelector(".__menu__sub__wrapper");if(!i)return;var r=i.offsetWidth,m=i.offsetHeight,d=window.innerWidth,l=window.innerHeight,s=t.getBoundingClientRect(),c=s.top,b=s.left;_.value=b+a+r>d-5?b-r+5:b+a,o.value=c+m>l-5?l-m:c+5}},show:function(n,t){return void 0===n&&(n=0),void 0===t&&(t=0),x(i,void 0,void 0,(function(){var a,i,_,o,u;return C(this,(function(c){switch(c.label){case 0:return l.value=document.elementFromPoint(n-1,t-1),e.menuHiddenFn?d.value=!e.menuHiddenFn(e.params,l.value,e.el):d.value=!0,d.value?(s.value=S(e.menuList),s.value=p(s.value,l.value,e.el,e.params),[4,y()]):[2];case 1:return c.sent(),a=window.innerWidth,i=window.innerHeight,_=v.value,o=_.offsetHeight,u=e.menuWidth||200,m.value=n+u+1>a?a-u-5:n+1,r.value=t+o+1>i?i-o-5:t+1,[2]}}))}))},close:function(){d.value=!1}}}});const M=m();d("data-v-3d21bc0a");const z={key:0,class:"__menu__item-icon"},T={class:"__menu__item-label"},L={class:"__menu__item-tips"},I={class:"__menu__item-arrow-after"},F={class:"__menu__sub__item-label"},W={class:"__menu__sub__item-tips"};l();const E=M(((e,n,t,a,m,d)=>(s(),i(r,{to:"body",disabled:!e.appendToBody},[e.showMenu?(s(),i("div",{key:0,ref:"MenuWrapper",class:"__menu__wrapper",style:{width:`${e.menuWidth}px`,top:`${e.menuTop}px`,left:`${e.menuLeft}px`}},[(s(!0),i(_,null,o(e.calcMenuList,((n,t)=>(s(),i(_,null,[n.hidden||n.line?u("v-if",!0):(s(),i("div",{key:t,class:["__menu__item",{disabled:n.disabled}],onMousedown:c((t=>e.handleMenuItemClick(n)),["stop"]),onMouseenter:t=>e.handleMenuMouseEnter(t,n)},[e.hasIcon?(s(),i("span",z,["font-icon"===e.iconType?b((s(),i("i",{key:0,class:n.icon},null,2)),[[v,n.icon]]):u("v-if",!0)])):u("v-if",!0),p("span",T,h(n.label),1),p("span",L,h(n.tips||""),1),e.hasSubMenu?(s(),i("span",{key:1,class:["__menu__item-arrow",{show:e.hasSubMenu&&n.children}],style:{width:e.arrowSize+"px",height:e.arrowSize+"px"}},[b(p("span",I,null,512),[[v,e.hasSubMenu&&n.children]])],6)):u("v-if",!0),n.children&&n.children.length>0?b((s(),i("div",{key:2,class:"__menu__sub__wrapper",style:{top:`${e.subTop}px`,left:`${e.subLeft}px`}},[(s(!0),i(_,null,o(n.children,((n,t)=>(s(),i(_,null,[n.hidden||n.line?u("v-if",!0):(s(),i("div",{key:t,class:["__menu__sub__item",{disabled:n.disabled}],onMousedown:c((t=>e.handleSubMenuItemClick(n)),["stop"])},[p("span",F,h(n.label),1),p("span",W,h(n.tips||""),1)],42,["onMousedown"])),n.line?(s(),i("div",{key:t,class:"__menu__line"})):u("v-if",!0)],64)))),256))],4)),[[v,e.hoverFlag]]):u("v-if",!0)],42,["onMousedown","onMouseenter"])),n.line?(s(),i("div",{key:t,class:"__menu__line"})):u("v-if",!0)],64)))),256))],4)):u("v-if",!0)],8,["disabled"]))));var j;function B(e){var n,t,a="__mouse__menu__container";t=document.querySelector("."+a)?document.querySelector("."+a):function(e,n,t){var a=document.createElement(e);return a.setAttribute("class",n),t&&(a.innerText=t),a}("div",a);var i=f(k,e);return w(i,t),document.body.appendChild(t),null===(n=i.component)||void 0===n?void 0:n.proxy}!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===t&&a.firstChild?a.insertBefore(i,a.firstChild):a.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".__menu__mask[data-v-3d21bc0a] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  z-index: 999;\n}\n.__menu__wrapper[data-v-3d21bc0a] {\n  --menu-background: #c8f2f0;\n  --menu-boxShadow: 0 1px 5px #888;\n  --menu-padding: 5px 0;\n  --menu-borderRadius: 0;\n  --menu-item-height: 30px;\n  --menu-item-padding: 0 10px;\n  --menu-item-iconSize: 20px;\n  --menu-item-iconFontSize: 14px;\n  --menu-item-iconColor: #484852;\n  --menu-item-labelColor: #484852;\n  --menu-item-labelFontSize: 14px;\n  --menu-item-tipsColor: #889;\n  --menu-item-tipsFontSize: 12px;\n  --menu-item-arrowColor: #484852;\n  --menu-item-disabledColor: #bcc;\n  --menu-item-hoverBackground: rgba(255, 255, 255, 0.8);\n  --menu-item-hoverIconColor: inherit;\n  --menu-item-hoverLabelColor: inherit;\n  --menu-item-hoverTipsColor: inherit;\n  --menu-item-hoverArrowColor: inherit;\n  --menu-lineColor: #ccc;\n  --menu-lineMargin: 5px 0;\n}\n.__menu__wrapper[data-v-3d21bc0a] {\n  position: fixed;\n  width: 200px;\n  background: var(--menu-background);\n  box-shadow: var(--menu-boxShadow);\n  padding: var(--menu-padding);\n  border-radius: var(--menu-borderRadius);\n  z-index: 99999;\n}\n.__menu__line[data-v-3d21bc0a],\n.__menu__sub__line[data-v-3d21bc0a] {\n  border-top: 1px solid var(--menu-lineColor);\n  margin: var(--menu-lineMargin);\n}\n.__menu__item[data-v-3d21bc0a],\n.__menu__sub__item[data-v-3d21bc0a] {\n  display: flex;\n  height: var(--menu-item-height);\n  line-height: var(--menu-item-height);\n  align-items: center;\n  cursor: pointer;\n  padding: 0 10px;\n}\n.__menu__item .__menu__item-icon[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon[data-v-3d21bc0a] {\n  color: var(--menu-item-iconColor);\n  width: var(--menu-item-iconSize);\n  height: var(--menu-item-iconSize);\n  line-height: var(--menu-item-iconSize);\n}\n.__menu__item .__menu__item-icon i[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon i[data-v-3d21bc0a] {\n  font-size: var(--menu-item-iconFontSize);\n}\n.__menu__item .__menu__item-label[data-v-3d21bc0a],\n.__menu__item .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-label[data-v-3d21bc0a],\n.__menu__sub__item .__menu__sub__item-label[data-v-3d21bc0a] {\n  width: 100%;\n  max-height: 100%;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  flex: 1;\n  font-size: var(--menu-item-labelFontSize);\n  color: var(--menu-item-labelColor);\n  margin-right: 5px;\n  overflow: hidden;\n}\n.__menu__item .__menu__item-tips[data-v-3d21bc0a],\n.__menu__item .__menu__sub__item-tips[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-tips[data-v-3d21bc0a],\n.__menu__sub__item .__menu__sub__item-tips[data-v-3d21bc0a] {\n  font-size: var(--menu-item-tipsFontSize);\n  color: var(--menu-item-tipsColor);\n}\n.__menu__item .__menu__item-arrow[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-arrow[data-v-3d21bc0a] {\n  width: 10px;\n  height: 10px;\n  margin-left: 5px;\n  position: relative;\n}\n.__menu__item.disabled[data-v-3d21bc0a],\n.__menu__sub__item.disabled[data-v-3d21bc0a] {\n  cursor: not-allowed;\n}\n.__menu__item.disabled .__menu__item-icon[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__item-label[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__item-tips[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__sub__item-tips[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-icon[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-label[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-tips[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__sub__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-disabledColor);\n}\n.__menu__item.disabled .__menu__item-arrow .__menu__item-arrow-after[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-arrow .__menu__item-arrow-after[data-v-3d21bc0a] {\n  border-left: var(--menu-item-arrowRealSize) solid var(--menu-item-disabledColor);\n}\n.__menu__item[data-v-3d21bc0a]:not(.disabled):hover {\n  background: var(--menu-item-hoverBackground);\n}\n.__menu__item:not(.disabled):hover .__menu__item-icon[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverIconColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-label[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverLabelColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverTipsColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-arrow[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverArrowColor);\n}\n.__menu__sub__item[data-v-3d21bc0a]:not(.disabled):hover {\n  background: var(--menu-item-hoverBackground);\n}\n.__menu__sub__item:not(.disabled):hover .__menu__sub__item-label[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverLabelColor);\n}\n.__menu__sub__item:not(.disabled):hover .__menu__sub__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverTipsColor);\n}\n.__menu__item-icon[data-v-3d21bc0a] {\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  line-height: 20px;\n  margin-right: 4px;\n}\n.__menu__item-arrow.show .__menu__item-arrow-after[data-v-3d21bc0a] {\n  position: absolute;\n  width: 0;\n  height: 0;\n  left: 8px;\n  border-left: var(--menu-item-arrowRealSize) solid var(--menu-item-arrowColor);\n  border-top: var(--menu-item-arrowRealSize) solid transparent;\n  border-bottom: var(--menu-item-arrowRealSize) solid transparent;\n}\n.__menu__sub__wrapper[data-v-3d21bc0a] {\n  position: fixed;\n  visibility: hidden;\n  width: 200px;\n  background: var(--menu-background);\n  box-shadow: var(--menu-boxShadow);\n  padding: var(--menu-padding);\n  border-radius: var(--menu-borderRadius);\n}\n.__menu__item:hover .__menu__sub__wrapper[data-v-3d21bc0a] {\n  visibility: visible;\n}"),k.render=E,k.__scopeId="data-v-3d21bc0a",k.__file="packages/mouse-menu/mouse-menu.vue",k.install=function(e){e.component(k.name,k)};var O={mounted:function(e,n){var t=n.value;if(!(t.menuList.length>0))throw new Error("At least set one menu list!");j=function(n){var a=B(g({el:e},t));2===n.button?(n.stopPropagation(),document.oncontextmenu=function(e){e.preventDefault();var n=e.x,t=e.y;a.show(n,t)},document.onmousedown=function(){document.oncontextmenu=null,a.close()}):a.close()},e.removeEventListener("mousedown",j),e.addEventListener("mousedown",j)},unmounted:function(e){e.removeEventListener("mousedown",j)}};export{O as M};
